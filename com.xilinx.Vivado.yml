app-id: com.xilinx.Vivado
runtime: org.freedesktop.Platform
runtime-version: '19.08'
sdk: org.freedesktop.Sdk
command: com.xilinx.Vivado
tags:
  - proprietary

finish-args:
  - --share=ipc
  - --socket=wayland
  - --socket=x11
  - --share=network
  - --device=all
  - --persist=.
  - --filesystem=xdg-documents

modules:
  - name: ncurses5
    config-opts:
      - --with-shared
      - --with-normal
      - --without-debug
      - --without-ada
      - --enable-widec
      - --disable-pc-files
      - --with-cxx-binding
      - --with-cxx-shared
      - --with-versioned-syms
      - --with-abi-version=5
    post-install:
      - for lib in ncurses ncurses++ form panel menu; do ln -s lib${lib}w.so.5 /app/lib/lib${lib}.so.5; done
      - ln -s libncurses.so.5 /app/lib/libtinfo.so.5
      - ln -s libncurses.so.5 /app/lib/libtic.so.5
    cleanup:
      - /bin
      - /include
      - /lib/debug
      - /lib/*.a
      - /share/man
    sources:
      - type: archive
        url: https://ftp.gnu.org/pub/gnu/ncurses/ncurses-6.2.tar.gz
        sha256: 30306e0c76e0f9f1f0de987cf1c82a5c21e1ce6568b9227f7da5b71cbea86c9d

  - name: keyutils
    buildsystem: simple
    build-commands:
      - sed -i 's|$(LNS) $(LIBDIR)/|$(LNS) |' Makefile && make DESTDIR=/app LIBDIR=/lib NO_ARLIB=1 install
    cleanup:
      - /bin
      - /etc
      - /sbin
      - /usr
      - /lib/debug
      - /lib/pkgconfig
    sources:
      - type: archive
        url: https://people.redhat.com/~dhowells/keyutils/keyutils-1.6.1.tar.bz2
        sha256: c8b15722ae51d95b9ad76cc6d49a4c2cc19b0c60f72f61fb9bf43eea7cbd64ce

  - name: icoutils
    cleanup:
      - "*"
    sources:
      - type: archive
        url: http://savannah.nongnu.org/download/icoutils/icoutils-0.32.3.tar.bz2
        sha256: 17abe02d043a253b68b47e3af69c9fc755b895db68fdc8811786125df564c6e0

  - name: xilinx
    buildsystem: simple
    build-options:
      strip: false
      no-debuginfo: true
    build-commands:
      - "$FLATPAK_BUILDER_BUILDDIR/installer.sh"
    sources:
      - type: file
        path: installer.sh
      - type: file
        path: xilinx_unified_installer.conf
      - type: archive
        path: xilinx_unified_installer.tar.gz
        dest: installer
